---
import ArticleLayout from "./../../layout/article.astro";
import Render from "./../../components/richText/render.astro";
import { asText } from "@prismicio/client"
import { getProjectBySlug } from "../../feacture/prismic";
import { ArrowLeftIcon } from "@radix-ui/react-icons"
import { BadgeBySkill } from "../../components/badge";

const post = await getProjectBySlug({ slug: Astro.params.slug as string })

if (!post) {
    return new Response(null, {
        status: 404,
        statusText: 'Not found'
    });
}
const data = post.data;

const formattedPublishDate = new Date(post.last_publication_date).toLocaleDateString(
	"es-Bo",
	{
		year: "numeric",
		month: "long",
		day: "numeric",
	}
);
---
<ArticleLayout
    title={asText(data.title)}
    description={asText(data.description)}
    image={data.image.url as string}
>
    <header class="text-center pb-4">
        <span class="block mb-4">
            <time datetime={formattedPublishDate}>{formattedPublishDate}</time>
        </span>
        <Render content={data.title} />
        <div class="flex items-center justify-center gap-2 flex-wrap">
            {post.tags.map((x, i) => (
                <a href={`/tag/${x}`} class="no-underline">
                    <BadgeBySkill text={x} />
                </a>
            ))}
        </div>
    </header>
    <article>
        <Render content={data.body} />
    </article>
    <div>
        <a href="/project" class="flex gap-2 items-center no-underline hover:underline text-blue-500">
            <ArrowLeftIcon width={16} height={16} />
            <span>
                Ver mas Projectos
            </span>
        </a>
    </div>
    <footer>
    </footer>
</ArticleLayout>